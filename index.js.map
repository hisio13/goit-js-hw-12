{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst baseUrl = \"https://pixabay.com\";\nconst endPoint = \"/api\";\n\nexport function getImg(searchName, page = 1, perPage = 40) {\n    const params = new URLSearchParams({\n        key: '48827773-420cc6a3931f90379a2431d96',\n        q: searchName,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page,\n        per_page: perPage,\n    });\n\n    const url = `${baseUrl}${endPoint}?${params}`;\n    return axios.get(url);\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n    captionsData: 'alt',\n    captionDelay: 250,\n    close: 'true',\n});\n\nexport function displayImages(images) {\n    const gallery = document.getElementById('gallery');\n    \n    const markup = images.map(image => \n        `<li class=\"gallery-item\">\n            <a class='gallery-link' href=\"${image.largeImageURL}\">\n                <img class=\"li-img\" src=\"${image.webformatURL}\" alt=\"${image.tags}\"/> \n                <div class=\"li-text\">\n                    <table class=\"table\">\n                        <tr>\n                            <td>Likes</td>\n                            <td>Views</td>\n                            <td>Comments</td>\n                            <td>Downloads</td>\n                        </tr>\n                        <tr>\n                            <td>${image.likes}</td>\n                            <td>${image.views}</td>\n                            <td>${image.comments}</td>\n                            <td>${image.downloads}</td>\n                        </tr>\n                    </table>\n                </div>\n            </a>\n        </li>`\n    ).join(\"\");\n\n    lightbox.refresh();\n\n    gallery.insertAdjacentHTML(\"beforeend\", markup); \n    const cardHeight = document.querySelector(\".gallery-item\").getBoundingClientRect().height;\nwindow.scrollBy({\n    top: cardHeight * 2,\n    behavior: \"smooth\"\n});\n\n}\n\nexport function clearGallery() {\n    const gallery = document.getElementById('gallery');\n    gallery.innerHTML = '';\n    document.getElementById('loadMore').style.display = 'none'; \n}\n\nexport function showLoadingIndicator() {\n    document.getElementById('loading').style.display = 'block';\n}\n\nexport function hideLoadingIndicator() {\n    document.getElementById('loading').style.display = 'none';\n}\n\nexport function toggleLoadMoreButton(show) {\n    document.getElementById('loadMore').style.display = show ? 'block' : 'none';\n}\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { getImg } from \"./js/pixabay-api.js\";\nimport { displayImages, clearGallery, showLoadingIndicator, hideLoadingIndicator, toggleLoadMoreButton } from \"./js/render-functions.js\";\n\nexport const form = document.querySelector(\".form\");\nconst input = document.querySelector(\".input-search\");\nconst waitMsg = document.querySelector(\".wait-msg\");\n\nlet currentPage = 1; \nlet searchTerm = '';\n\nform.addEventListener(\"submit\", (e) => {\n    e.preventDefault();  \n\n    clearGallery();\n    waitMsg.innerHTML = '\"Wait, the image is loading\" <span class=\"loader\"></span>';\n  \n    const searchName = input.value.trim();\n    \n    if (!searchName) {\n        iziToast.show({\n            backgroundColor: 'rgba(239, 64, 64, 1)',\n            messageColor: `rgba(255, 255, 255, 1)`,\n            close: true,\n            position: \"topRight\",\n            title: 'Error',\n            titleColor: '#fff',\n            titleSize: '16px',\n            message: 'Input search string'\n        });\n        waitMsg.textContent = \"\";\n        return;\n    }\n\n    if (searchName !== searchTerm) {\n        searchTerm = searchName; \n        currentPage = 1; \n    } else {\n        currentPage++; \n    }\n  \n    fetchImages(searchTerm);\n});\n\ndocument.getElementById('loadMore').addEventListener('click', () => {\n    currentPage++; \n    fetchImages(searchTerm, true);\n});\n\nfunction fetchImages(searchTerm, isLoadMore = false) {\n    showLoadingIndicator(); \n    getImg(searchTerm, currentPage)\n        .then(response => {\n            const images = response.data.hits; \n            const totalHits = response.data.totalHits; \n\n            if (images.length === 0) {\n                iziToast.show({\n                    backgroundColor: 'rgba(239, 64, 64, 1)',\n                    messageColor: `rgba(255, 255, 255, 1)`,\n                    close: true,\n                    position: \"topRight\",\n                    title: 'Error',\n                    titleColor: '#fff',\n                    titleSize: '16px',\n                    message: 'Sorry, there are no images matching your search query. Please try again!'\n                });\n                toggleLoadMoreButton(false); \n            } else {\n                displayImages(images); \n\n                if (currentPage * 40 >= totalHits) {\n                    iziToast.show({\n                        backgroundColor: 'rgba(255, 165, 0, 1)', \n                        messageColor: '#fff',\n                        close: true,\n                        position: \"topRight\",\n                        title: 'Info',\n                        titleColor: '#fff',\n                        titleSize: '16px',\n                        message: 'You have reached the last page of results.'\n                    });\n                    toggleLoadMoreButton(false);\n                } else {\n                    toggleLoadMoreButton(true);\n                }\n\n                if (isLoadMore) {\n                    smoothScroll();\n                }\n            }\n            waitMsg.textContent = \"\";\n        })\n        .catch(error => {\n            waitMsg.textContent = \"\";\n            iziToast.show({\n                backgroundColor: 'rgba(239, 64, 64, 1)',\n                messageColor: '#fff',\n                close: true,\n                position: \"topRight\",\n                title: 'Error',\n                titleColor: '#fff',\n                titleSize: '16px',\n                message: 'Something went wrong! Please try again later.'\n            });\n            console.error(error);\n        })\n        .finally(() => {\n            hideLoadingIndicator(); \n        });\n}\n\nfunction smoothScroll() {\n    const gallery = document.querySelector(\".gallery\");\n    if (gallery.children.length >= 2) {\n        const secondLastImage = gallery.children[gallery.children.length - 2]; \n        secondLastImage.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n    }\n}\n"],"names":["baseUrl","endPoint","getImg","searchName","page","perPage","params","url","axios","lightbox","SimpleLightbox","displayImages","images","gallery","markup","image","cardHeight","clearGallery","showLoadingIndicator","hideLoadingIndicator","toggleLoadMoreButton","show","form","input","waitMsg","currentPage","searchTerm","e","iziToast","fetchImages","isLoadMore","response","totalHits","smoothScroll","error"],"mappings":"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"}